{"version":3,"sources":["../../lib/Firefox/Tab.js"],"names":[],"mappings":";;;;;;;;;;AAAA,IAAM,SAAS,GAAG,OAAO,CAAC,aAAa,CAAC,CAAC;;eACnB,OAAO,CAAC,uBAAuB,CAAC;;IAA9C,SAAS,YAAT,SAAS;;IAEX,GAAG;WAAH,GAAG;;AACG,UADN,GAAG,CACI,IAAI,EAAE,MAAM,EAAE,cAAc,EAAE;;;wBADrC,GAAG;;AAEP,6BAFI,GAAG,6CAEC;AACR,MAAI,CAAC,KAAK,GAAG,IAAI,CAAC;AAClB,MAAI,CAAC,OAAO,GAAG,MAAM,CAAC;AACtB,MAAI,CAAC,eAAe,GAAG,cAAc,CAAC;AACtC,MAAI,CAAC,WAAW,GAAG,IAAI,CAAC;;AAExB,MAAI,CAAC,OAAO,CAAC,EAAE,CAAC,OAAO,EAAE,YAAM;AAC9B,SAAK,SAAS,EAAE,CAAC;GACjB,CAAC,CAAC;EACH;;cAXI,GAAG;;SAYC,qBAAG;;;AACX,OAAI,IAAI,CAAC,WAAW,EAAE,OAAO,IAAI,CAAC,WAAW,CAAC,GAAG,CAAC,QAAQ,EAAE,CAAC;;AAE7D,OAAI,CAAC,KAAK,CAAC,IAAI,CAAC;AACf,OAAG,EAAE,SAAS,CAAC,GAAG,CAAC,IAAI;AACvB,UAAM,EAAE,gBAAC,GAAG,EAAK;AAChB,YAAK,WAAW,GAAG,GAAG,CAAC,MAAM,CAAC;AAC7B,uBAAiB,EAAE,SAAS,CAAC,GAAG,CAAC,EAAE;MACnC,CAAC,CAAC;;AAEH,YAAK,WAAW,CAAC,EAAE,CAAC,SAAS,EAAE,UAAC,OAAO;aAAK,OAAK,eAAe,CAAC,qBAAqB,CAAC,OAAO,CAAC;MAAA,CAAC,CAAC;;AAEjG,YAAK,eAAe,CAAC,EAAE,CAAC,gBAAgB,EAAE,UAAC,SAAS,EAAc;wCAAT,IAAI;AAAJ,WAAI;;;AAC5D,UAAI,OAAO,GAAG,EAAE,SAAS,EAAT,SAAS,EAAE,IAAI,EAAE,OAAK,gBAAgB,MAAA,SAAI,IAAI,CAAC,EAAE,CAAC;AAClE,aAAK,WAAW,CAAC,WAAW,CAAC,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,CAAC,CAAC;MACtD,CAAC,CAAC;KACH;AACD,WAAO,EAAE,iBAAC,GAAG,EAAK;AACjB,YAAK,WAAW,GAAG,IAAI,CAAC;KACxB;IACD,CAAC,CAAC;GACH;;;SACe,4BAAU;;;AAGzB,OAAI,QAAQ,GAAG,SAAX,QAAQ,CAAI,GAAG,EAAE,KAAK;WAAK,OAAQ,KAAK,AAAC,KAAK,UAAU,GAAG,KAAM,CAAC,AAAC,GAAG,KAAK;IAAA,CAAC;;sCAH7D,IAAI;AAAJ,QAAI;;;AAKvB,UAAO,IAAI,CAAC,GAAG,CAAC,UAAA,QAAQ;WAAI,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,SAAS,CAAC,QAAQ,EAAE,QAAQ,CAAC,CAAC;IAAA,CAAC,CAAC;GAC5E;;;QAxCI,GAAG;GAAS,SAAS;;AA2C3B,MAAM,CAAC,OAAO,GAAG,GAAG,CAAC","file":"Tab.js","sourcesContent":["const Constants = require('./Constants');\r\nconst { Eventable } = require('omniscience-utilities');\r\n\r\nclass Tab extends Eventable {\r\n\tconstructor(tabs, button, frontEndBridge) {\r\n\t\tsuper();\r\n\t\tthis._tabs = tabs;\r\n\t\tthis._button = button;\r\n\t\tthis._frontEndBridge = frontEndBridge;\r\n\t\tthis._pageWorker = null;\r\n\r\n\t\tthis._button.on('click', () => {\r\n\t\t\tthis.openFocus();\r\n\t\t});\r\n\t}\r\n\topenFocus() {\r\n\t\tif (this._pageWorker) return this._pageWorker.tab.activate();\r\n\r\n\t\tthis._tabs.open({\r\n\t\t\turl: Constants.tab.html,\r\n\t\t\tonLoad: (tab) => {\r\n\t\t\t\tthis._pageWorker = tab.attach({\r\n\t\t\t\t\tcontentScriptFile: Constants.tab.js\r\n\t\t\t\t});\r\n\r\n\t\t\t\tthis._pageWorker.on(\"message\", (message) => this._frontEndBridge.onMessageFromFrontEnd(message));\r\n\r\n\t\t\t\tthis._frontEndBridge.on(\"sendToFrontEnd\", (eventType, ...data) => {\r\n\t\t\t\t\tvar message = { eventType, data: this._makeSafeForEmit(...data) };\r\n\t\t\t\t\tthis._pageWorker.postMessage(JSON.stringify(message));\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tonClose: (tab) => {\r\n\t\t\t\tthis._pageWorker = null;\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\t_makeSafeForEmit(...args) {\r\n\t\t//The panel serializes out the data object using the below two lines\r\n\t\t//the tab does not, therefore the same data sent to both will not appear the same unless we add the below lines\r\n\t\tvar replacer = (key, value) => typeof (value) === \"function\" ? void (0) : value;\r\n\r\n\t\treturn args.map(argument => JSON.parse(JSON.stringify(argument, replacer)));\r\n\t}\r\n}\r\n\r\nmodule.exports = Tab;"]}